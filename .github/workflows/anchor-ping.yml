name: Anti-Cream Anchor

on:
  schedule:
    - cron: "0,30 * * * *"   # ทุกครึ่งชั่วโมง ตลอด 24 ชม. (UTC)
  workflow_dispatch:

jobs:
  anchor:
    runs-on: ubuntu-latest
    steps:
      - name: Send anti-cream prompt to OpenAI
        env:
          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
        run: |
          JSON='{"model":"gpt-4o-mini","messages":[{"role":"user","content":"ANCHOR: Reply with exactly: OK"}]}'
          RESP=$(curl -sS https://api.openai.com/v1/chat/completions \
            -H "Authorization: Bearer $OPENAI_API_KEY" \
            -H "Content-Type: application/json" \
            -d "$JSON")
          echo "$RESP" | jq -r '.choices[0].message.content'
